import{d as o,s as n,M as c,S as d,l as u,P as h,T as A,_ as C,o as D,c as F,a as i,n as r,p as v,b as f}from"./index-DuologgT.js";const k=o({data(){return{track1:[],track2:[],track3:[],isActive1:!1,isActive2:!1,isActive3:!1,timer1:null,timer2:null,timer3:null,Player:null,isActive:!1,timer:null,playing:!1,currentTime:0,currentIndex:0,playArr:[1,3,4,5,8,9,10,12,14,17,19,20,21,22,23,24,25,26]}},components:{},computed:{},async mounted(){var t;this.initKeyNote(),(t=document.querySelector("body"))==null||t.addEventListener("click",async()=>{await n()},!1)},methods:{initKeyNote(){const t={A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"};let e=0,a=[[],[],[]];for(let m in t)a[e].push(m),e++,e=e>=3?0:e;this.track1=a[0],this.track2=a[1],this.track3=a[2]},async playMIDI(){let t=await c.Midi.fromUrl("/ai-music/dist/1.mid");await n();const e=new d({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,baseUrl:"https://tonejs.github.io/audio/salamander/",onload:()=>{u().then(()=>{t.tracks[0].notes,new h((m,s)=>{e.triggerAttackRelease(s.name,s.duration,m),this.track1.indexOf(s.name)>=0?(clearTimeout(this.timer1),this.isActive1=!0,this.timer1=setTimeout(()=>{this.isActive1=!1},50)):this.track2.indexOf(s.name)>=0?(clearTimeout(this.timer2),this.isActive2=!0,this.timer2=setTimeout(()=>{this.isActive2=!1},50)):(clearTimeout(this.timer3),this.isActive3=!0,this.timer3=setTimeout(()=>{this.isActive3=!1},50))},t.tracks.flatMap(m=>m.notes.map(s=>({time:s.time,name:s.name,duration:s.duration})))).start(0)}),A.start()}}).toDestination();await e.loaded,window.currentSampler=e},handleClose(){location.reload()},handleStart(){this.playing=!0,this.playMIDI(),this.currentTime=0,this.currentIndex=0},handleLoop(){if(this.currentTime=this.currentTime+50,this.playArr[this.currentIndex]*500===this.currentTime&&(this.isActive=!0,this.currentIndex=this.currentIndex+1,setTimeout(()=>{this.isActive=!1},200)),this.currentIndex>=this.playArr.length){clearTimeout(this.timer);return}this.timer=setTimeout(()=>{this.handleLoop()},50)},closeLoop(){clearTimeout(this.timer)},handleCancel(){this.$refs.keyboard.handleFinishAI()}}}),p=t=>(v("data-v-11214635"),t=t(),f(),t),y={class:"test"},T=p(()=>i("br",null,null,-1)),I=p(()=>i("input",{type:"file",id:"midiInput",accept:".mid,.midi"},null,-1)),b={class:"block-box"};function w(t,e,a,m,s,S){return D(),F("div",y,[i("h1",{onClick:e[0]||(e[0]=(...l)=>t.handleStart&&t.handleStart(...l))},"开始音乐"),i("h1",{onClick:e[1]||(e[1]=(...l)=>t.handleClose&&t.handleClose(...l))},"关闭音乐"),T,I,i("div",{class:r(["ball",{active:t.isActive}])},null,2),i("div",b,[i("div",{class:r(["block",{active:t.isActive1}])},null,2),i("div",{class:r(["block",{active:t.isActive2}])},null,2),i("div",{class:r(["block",{active:t.isActive3}])},null,2)])])}const g=C(k,[["render",w],["__scopeId","data-v-11214635"]]);export{g as default};
